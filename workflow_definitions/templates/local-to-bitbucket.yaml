# Excel Differ Workflow: Local Folder â†’ Bitbucket
# Use case: Process Excel files from local folder, upload flattened outputs to Bitbucket

# Logging configuration
logging:
  log_dir: ./logs

# State file configuration
state:
  file_path: ./tmp/state/.excel-differ-state.json

source:
  implementation: local_folder
  config:
    folder_path: ./tmp/input            # Input directory (create this folder)
    include_patterns:
      - "**/*.xlsx"
      - "**/*.xlsm"
      - "**/*.xlsb"
    exclude_patterns:
      - "**/~$*"          # Excel temp files
      - "**/.~lock.*"     # LibreOffice lock files

destination:
  implementation: bitbucket
  config:
    url: https://api.bitbucket.org/2.0/repositories/myworkspace/my-repo
    branch: main
    output_path: flattened/

converter:
  implementation: noop
  config: {}

flattener:
  implementation: openpyxl
  config:
    include_computed: false
    include_literal: true
    include_formats: true
    timeout: 900
